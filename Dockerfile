# Use PHP 8.3 with Apache as the base image\nFROM php:8.3-apache\n\n# Install system dependencies\nRUN apt-get update && apt-get install -y \\\n    git \\\n    libpng-dev \\\n    libonig-dev \\\n    libxml2-dev \\\n    zip \\\n    unzip \\\n    nodejs \\\n    npm\n\n# Clear cache\nRUN apt-get clean && rm -rf /var/lib/apt/lists/*\n\n# Install PHP extensions\nRUN docker-php-ext-install pdo_mysql mbstring exif pcntl bcmath gd\n\n# Get latest Composer\nCOPY --from=composer:latest /usr/bin/composer /usr/bin/composer\n\n# Set working directory\nWORKDIR /var/www/html\n\n# Copy existing application directory contents\nCOPY . .\n\n# Install PHP dependencies\nRUN composer install --optimize-autoloader --no-dev\n\n# Install Node dependencies and build\nRUN npm install && npm run build\n\n# Set permissions\nRUN chown -R www-data:www-data /var/www/html\n\n# Apache configuration\nRUN a2enmod rewrite\nCOPY ./docker/000-default.conf /etc/apache2/sites-available/000-default.conf\n\n# Expose port 80\nEXPOSE 80\n\n# Start Apache\nCMD [\"apache2-foreground\"]